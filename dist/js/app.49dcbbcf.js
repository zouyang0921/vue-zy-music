(function(t){function e(e){for(var r,i,s=e[0],o=e[1],l=e[2],u=0,d=[];u<s.length;u++)i=s[u],a[i]&&d.push(a[i][0]),a[i]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);f&&f(e);while(d.length)d.shift()();return c.push.apply(c,l||[]),n()}function n(){for(var t,e=0;e<c.length;e++){for(var n=c[e],r=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(r=!1)}r&&(c.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},i={app:0},a={app:0},c=[];function s(t){return o.p+"js/"+({}[t]||t)+"."+{"chunk-37ac2cc1":"72777aee","chunk-0ccf2e3e":"56fad49d","chunk-1c6ef972":"6394a3ba","chunk-730d24b5":"0f5324e7","chunk-c54dce9c":"dc6c4b8f","chunk-e8d7c4ee":"3c109113","chunk-f2714cba":"8a0ed5d5","chunk-f6b15a0e":"2349cc4a"}[t]+".js"}function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(t){var e=[],n={"chunk-37ac2cc1":1,"chunk-0ccf2e3e":1,"chunk-1c6ef972":1,"chunk-730d24b5":1,"chunk-c54dce9c":1,"chunk-e8d7c4ee":1,"chunk-f2714cba":1,"chunk-f6b15a0e":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise(function(e,n){for(var r="css/"+({}[t]||t)+"."+{"chunk-37ac2cc1":"8e647768","chunk-0ccf2e3e":"8bc6a32e","chunk-1c6ef972":"ea5e2773","chunk-730d24b5":"a4124d4b","chunk-c54dce9c":"a7db0184","chunk-e8d7c4ee":"11163d3d","chunk-f2714cba":"bf5c285f","chunk-f6b15a0e":"5991d29e"}[t]+".css",a=o.p+r,c=document.getElementsByTagName("link"),s=0;s<c.length;s++){var l=c[s],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===r||u===a))return e()}var d=document.getElementsByTagName("style");for(s=0;s<d.length;s++){l=d[s],u=l.getAttribute("data-href");if(u===r||u===a)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var r=e&&e.target&&e.target.src||a,c=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");c.request=r,delete i[t],f.parentNode.removeChild(f),n(c)},f.href=a;var p=document.getElementsByTagName("head")[0];p.appendChild(f)}).then(function(){i[t]=0}));var r=a[t];if(0!==r)if(r)e.push(r[2]);else{var c=new Promise(function(e,n){r=a[t]=[e,n]});e.push(r[2]=c);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,o.nc&&u.setAttribute("nonce",o.nc),u.src=s(t),l=function(e){u.onerror=u.onload=null,clearTimeout(d);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src,c=new Error("Loading chunk "+t+" failed.\n("+r+": "+i+")");c.type=r,c.request=i,n[1](c)}a[t]=void 0}};var d=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(e)},o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/",o.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var f=u;c.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0251":function(t,e,n){t.exports=n.p+"img/default_cover.23db8941.jpg"},"2e0d":function(t,e,n){},"4a40":function(t,e,n){t.exports=n.p+"img/rod.24b8b7ab.png"},"4ec3":function(t,e,n){"use strict";n.d(e,"b",function(){return c}),n.d(e,"h",function(){return s}),n.d(e,"g",function(){return o}),n.d(e,"i",function(){return l}),n.d(e,"c",function(){return u}),n.d(e,"j",function(){return d}),n.d(e,"f",function(){return f}),n.d(e,"e",function(){return p}),n.d(e,"a",function(){return h}),n.d(e,"d",function(){return y});var r=n("bc3a"),i=n.n(r),a=n("b21a");function c(){return i.a.get("/banner")}function s(){return i.a.get("/personalized")}function o(){return i.a.get("/personalized/newsong")}function l(){return i.a.get("/toplist/detail")}function u(){return i.a.get("/search/hot")}function d(t){return i.a.get("/search?keywords=".concat(t))}function f(t){return i.a.get("/playlist/detail?id=".concat(t))}function p(t){return i.a.get("/song/detail?ids=".concat(t))}function h(t){return i.a.get("/check/music?id=".concat(t))}function y(t){return i.a.get("/lyric?id=".concat(t))}i.a.defaults.baseURL=a["a"]},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("keep-alive",[n("router-view")],1),n("player")],1)},a=[],c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"show",rawName:"v-show",value:t.playlist.length>0,expression:"playlist.length > 0"}],staticClass:"player-container"},[r("transition",{attrs:{name:"normal"},on:{enter:t.enter,"after-enter":t.afterEnter,leave:t.leave,"after-leave":t.afterLeave}},[r("div",{directives:[{name:"show",rawName:"v-show",value:"normal"===t.playerApparence,expression:"playerApparence === 'normal'"}],ref:"playerCoverWrap",staticClass:"normal-player"},[t.currentMusic.coverImage?r("div",{staticClass:"player-bg",style:{"background-image":"url("+t.currentMusic.coverImage+")"}}):r("div",{staticClass:"player-bg",style:{"background-image":"url(../../assets/images/default_cover.jpg)"}}),r("div",{staticClass:"header-mask"}),r("div",{staticClass:"header"},[r("i",{staticClass:"back",on:{click:t.goBack}}),r("div",{staticClass:"title"},[r("h1",[t._v(t._s(t.currentMusic.name))]),r("div",{staticClass:"artist"},[t._v(t._s(t.currentMusic.artist))])])]),r("div",{staticClass:"player-main",on:{click:t.switchCurrentShow}},[r("div",{directives:[{name:"show",rawName:"v-show",value:!t.lyricVisible,expression:"!lyricVisible"}],staticClass:"player-cover-container"},[r("img",{staticClass:"cover-rod",class:[t.isPlaying?"active":""],attrs:{src:n("4a40")}}),r("div",{staticClass:"cover-wrap",class:[t.isPlaying?"active":""]},[r("img",{staticClass:"cover-cd",attrs:{src:n("e771")}}),t.currentMusic.coverImage?r("div",{staticClass:"player-cover",style:{"background-image":"url("+t.currentMusic.coverImage+")"}}):r("div",{staticClass:"player-cover",style:{"background-image":"url(../../assets/images/default_cover.jpg)"}})])]),r("div",{directives:[{name:"show",rawName:"v-show",value:t.lyricVisible,expression:"lyricVisible"}],ref:"lyricList",staticClass:"player-lyric"},[t.lyric?r("div",{staticClass:"lyric-wrapper",style:t.lyricPosTop},[t.currentMusic.id?t.noLyric?r("p",[t._v("暂无歌词！")]):t.lyric.length>0?t._l(t.lyric,function(e,n){return r("p",{key:n,staticClass:"text",class:{current:t.lyricIndex===n}},[t._v(t._s(e.text))])}):r("p",[t._v("歌词加载失败！")]):r("p",[t._v("还没有播放音乐哦！")])],2):t._e()])]),r("div",{staticClass:"player-controller"},[r("div",{staticClass:"progress-wrap"},[r("div",{staticClass:"current-time"},[t._v(t._s(t._f("formatTime")(t.currentTime)))]),r("div",{ref:"progressBar",staticClass:"progress-bar",on:{click:t.dragPlay}},[r("div",{ref:"playedProgress",staticClass:"progress-bar-played",style:{width:t.playedScale}}),r("div",{ref:"progressPoint",staticClass:"progress-bar-point",style:{left:t.playedScale},on:{touchstart:function(e){return e.preventDefault(),t.progressTouchStart(e)},touchmove:function(e){return e.preventDefault(),t.progressTouchMove(e)},touchend:t.progressTouchEnd}})]),r("div",{staticClass:"total-time"},[t._v(t._s(t._f("formatTime")(t.currentMusic.duration)))])]),r("div",{staticClass:"controller"},[r("div",{staticClass:"controller-btn prev",on:{click:t.prev}}),r("div",{staticClass:"controller-btn",class:[t.isPlaying?"play":"pause"],on:{click:t.play}}),r("div",{staticClass:"controller-btn next",on:{click:t.next}})])])])]),r("div",{directives:[{name:"show",rawName:"v-show",value:"mini"===t.playerApparence,expression:"playerApparence === 'mini'"}],staticClass:"mini-player",on:{click:t.openNormalPlayer}},[r("div",{staticClass:"song-cover",class:[t.isPlaying?"active":""]},[t.currentMusic.coverImage?r("img",{attrs:{src:t.currentMusic.coverImage}}):r("img",{attrs:{src:n("0251")}})]),r("div",{staticClass:"song-text"},[r("h4",{staticClass:"song-name"},[t._v(t._s(t.currentMusic.name))]),r("div",{staticClass:"song-artist"},[t._v(t._s(t.currentMusic.artist))])]),r("div",{staticClass:"operate-btn",class:[t.isPlaying?"play":"pause"],on:{click:function(e){return e.stopPropagation(),t.play(e)}}}),r("div",{staticClass:"playlist"})]),r("audio",{ref:"audio",attrs:{src:t.currentMusic.url}})],1)},s=[],o=n("e814"),l=n.n(o),u=n("cebc"),d=n("2f62"),f=n("99ee"),p=n.n(f),h=n("b21a"),y={initAudio:function(t){var e=t.audio;e.onprogress=function(){try{if(e.buffered.length>0){var n=t.currentMusic.duration,r=0;e.buffered.end(0),r=e.buffered.end(0)>n?n:e.buffered.end(0),t.bufferedProgress=r/n}}catch(i){console.log(i)}},e.onplay=function(){var e;clearTimeout(e),e=setTimeout(function(){t.musicReady=!0},100)},e.ontimeupdate=function(){t.currentTime=e.currentTime},e.onended=function(){t.playMode===h["b"].singleLoop?t.loop():t.next()},e.onerror=function(){alert("当前音乐不可播放，已自动播放下一首"),t.next()},e.onstalled=function(){var n;e.load(),t.setPlayingState(!1),clearTimeout(n),n=setTimeout(function(){t.setPlayingState(!0)},10)},e.oncanplay=function(){0!==t.playHistory.length&&t.currentMusic.id===t.playHistory[0].id||t.setPlayHistory(t.currentMusic)}}},g=y,m=n("4ec3");n("c5f6"),n("a481"),n("4917"),n("28a5");function v(t){for(var e=t.split("\n"),n=[],r=0;r<e.length;r++){var i=decodeURIComponent(e[r]),a=/\[\d*:\d*((\.|:)\d*)*\]/g,c=i.match(a);if(c)for(var s=i.replace(a,""),o=0,l=c.length;o<l;o++){var u=c[o],d=Number(String(u.match(/\[\d*/i)).slice(1)),f=Number(String(u.match(/:\d*/i)).slice(1)),p=60*d+f;""!==s&&n.push({time:p,text:s})}}return n}var b={data:function(){return{bufferedProgress:0,musicReady:!1,currentTime:0,lyricVisible:!1,lyric:[],noLyric:!1,lyricIndex:0,lyricTop:0,audio:null}},computed:Object(u["a"])({},Object(d["c"])(["playlist","isPlaying","currentIndex","currentMusic","playMode","playerApparence","playHistory"]),{playedScale:function(){return void 0!==this.currentMusic.duration&&void 0!==this.currentTime?"".concat(l()(this.currentTime/this.currentMusic.duration*100),"%"):"0%"},lyricPosTop:function(){return"transform :translate3d(0, ".concat(-32*(this.lyricIndex-this.lyricTop-1),"px, 0)")}}),methods:Object(u["a"])({},Object(d["d"])({setCurrentIndex:"SET_CURRENT_INDEX",setPlayingState:"SET_PLAYING_STATE",setPlayerApparence:"SET_PLAYER_APPARENCE"}),Object(d["b"])(["setPlayHistory"]),{enter:function(t,e){var n=this._getPosAndScale(),r=n.x,i=n.y,a=n.scale,c={0:{transform:"translate3d(".concat(r,"px, ").concat(i,"px, 0) scale(").concat(a,")")},60:{transform:"translate3d(0, 0, 0) scale(1.1)"},100:{transform:"translate3d(0, 0, 0) scale(1)"}};p.a.registerAnimation({name:"move",animation:c,presets:{duration:400,easing:"linear"}}),p.a.runAnimation(this.$refs.playerCoverWrap,"move",e)},afterEnter:function(){p.a.unregisterAnimation("move"),this.$refs.playerCoverWrap.style.animation=""},leave:function(t,e){this.$refs.playerCoverWrap.style.transition="all 0.4s";var n=this._getPosAndScale(),r=n.x,i=n.y,a=n.scale;this.$refs.playerCoverWrap.style.transform="translate3d(".concat(r,"px, ").concat(i,"px, 0) scale(").concat(a,")"),this.$refs.playerCoverWrap.addEventListener("transitionend",e)},afterLeave:function(){this.$refs.playerCoverWrap.style.transition="",this.$refs.playerCoverWrap.style.transform=""},_getPosAndScale:function(){var t=40,e=40,n=30,r=80,i=.8*window.innerWidth,a=t/i,c=-(window.innerWidth/2-e),s=window.innerHeight-r-i/2-n;return{x:c,y:s,scale:a}},goBack:function(){this.setPlayerApparence("mini")},openNormalPlayer:function(){this.setPlayerApparence("normal")},play:function(){this.musicReady?this.setPlayingState(!this.isPlaying):this.setPlayingState(!1)},prev:function(){if(this.musicReady)if(1===this.playlist.length)this.loop();else{var t=this.currentIndex-1;t<0&&(t=this.playlist.length-1),this.setCurrentIndex(t),!this.isPlaying&&this.musicReady&&this.setPlayingState(!0),this.musicReady=!1}},next:function(){if(this.musicReady)if(1===this.playlist.length)this.loop();else{var t=this.currentIndex+1;t===this.playlist.length&&(t=0),!this.isPlaying&&this.musicReady&&this.setPlayingState(!0),this.setCurrentIndex(t),this.musicReady=!1}},loop:function(){this.audio.currentTime=0,this.audio.play(),this.setPlayingState(!0),this.lyric.length>0&&(this.lyricIndex=0)},progressTouchStart:function(t){this.touch.initiated=!0,this.touch.startX=t.touches[0].pageX,this.touch.left=this.$refs.playedProgress.clientWidth},progressTouchMove:function(t){if(this.touch.initiated){var e=t.touches[0].pageX-this.touch.startX,n=Math.min(this.$refs.progressBar.clientWidth,Math.max(0,this.touch.left+e)),r=(n/this.$refs.progressBar.clientWidth*100).toFixed(2)+"%";this.$refs.playedProgress.style.width=r,this.$refs.progressPoint.style.left=r}},progressTouchEnd:function(){this.touch.initiated=!1;var t=this.$refs.playedProgress.clientWidth/this.$refs.progressBar.clientWidth;this.audio.currentTime=this.currentMusic.duration*t,this.isPlaying||this.togglePlaying()},dragPlay:function(t){var e=this.$refs.progressBar.offsetLeft,n=((t.pageX-e)/this.$refs.progressBar.clientWidth).toFixed(4);this.$refs.playedProgress.style.width=100*n+"%",this.$refs.progressPoint.style.left=100*n+"%",this.audio.currentTime=this.currentMusic.duration*n,this.isPlaying||this.togglePlaying()},togglePlaying:function(){this.musicReady&&this.setPlayingState(!this.isPlaying)},switchCurrentShow:function(){this.lyricVisible=!this.lyricVisible},_getLyric:function(t){var e=this;Object(m["d"])(t).then(function(t){200===t.data.code&&(t.data.nolyric?e.noLyric=!0:(e.noLyric=!1,e.lyric=v(t.data.lrc.lyric)),e.audio.play())}).catch(function(){e.lyric=null,e.lyricIndex=0})}}),filters:{formatTime:function(t){if(t){var e="".concat(l()(t/60));e=e.length>1?e:"0".concat(e);var n="".concat(l()(t%60));return n=n.length>1?n:"0".concat(n),"".concat(e,":").concat(n)}return"00:00"}},created:function(){this.touch={}},mounted:function(){var t=this;this.$nextTick(function(){t.audio=t.$refs.audio,g.initAudio(t)})},watch:{currentMusic:function(t,e){var n=this;if(t.id){if(t.id!==e.id){this.audio.src=t.url,this.lyricIndex=this.currentTime=this.bufferedProgress=0;try{this.audio.play()}catch(r){console.log(r)}this.$nextTick(function(){n._getLyric(t.id)})}}else this.lyric=[]},isPlaying:function(t){var e=this;this.$nextTick(function(){t?e.audio.play():e.audio.pause(),e.musicReady=!0})},currentTime:function(t){if(!this.nolyric){for(var e=0,n=0;n<this.lyric.length;n++)t>this.lyric[n].time&&(e=n);this.lyricIndex=e}}}},P=b,k=(n("ad9a"),n("2877")),x=Object(k["a"])(P,c,s,!1,null,"7751863b",null),C=x.exports,w={components:{Player:C}},_=w,T=Object(k["a"])(_,i,a,!1,null,"6c07ad76",null),S=T.exports,I=n("8c4f"),A=[{path:"/",redirect:"/index"},{path:"/index",component:function(){return n.e("chunk-e8d7c4ee").then(n.bind(null,"37f9"))},children:[{path:"/",redirect:"recommend"},{path:"recommend",component:function(){return Promise.all([n.e("chunk-37ac2cc1"),n.e("chunk-1c6ef972")]).then(n.bind(null,"0075"))}},{path:"rank",component:function(){return n.e("chunk-730d24b5").then(n.bind(null,"6688"))}}]},{path:"/playlist/:id",component:function(){return n.e("chunk-c54dce9c").then(n.bind(null,"3fb6"))}},{path:"/search",component:function(){return Promise.all([n.e("chunk-37ac2cc1"),n.e("chunk-0ccf2e3e")]).then(n.bind(null,"1ef7"))}},{path:"/mine",component:function(){return n.e("chunk-f2714cba").then(n.bind(null,"ac78"))}},{path:"/history",component:function(){return n.e("chunk-f6b15a0e").then(n.bind(null,"006a"))}}],M=new I["a"]({routes:A}),E=n("f499"),j=n.n(E),L=(n("20d6"),n("a745")),O=n.n(L),$={get:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(window.localStorage)return localStorage.getItem(t)?O()(e)?JSON.parse(localStorage.getItem(t)):localStorage.getItem(t):e},set:function(t,e){window.localStorage&&localStorage.setItem(t,e)},clear:function(t){window.localStorage&&localStorage.removeItem(t)}},N="__historyList__",R=100;function W(t){var e=$.get(N),n=e.findIndex(function(e){return e.id===t.id});return 0===n?e:(n>0&&e.splice(n,1),e.unshift(t),R&&e.length>R&&e.pop(),$.set(N,j()(e)),e)}function H(){return $.get(N)}function B(){return $.clear(N),[]}var V,X={playlist:[],currentIndex:-1,isPlaying:!1,playMode:h["b"].listLoop,playHistory:H()||[],playerApparence:"",song:{id:-1,info:{name:"",artist:"",coverUrl:""},url:"",duration:0,currentTime:0}},Y=X,U={playlist:function(t){return t.playlist},currentIndex:function(t){return t.currentIndex},currentMusic:function(t){return t.playlist[t.currentIndex]||{}},isPlaying:function(t){return t.isPlaying},playMode:function(t){return t.playMode},playHistory:function(t){return t.playHistory},playerApparence:function(t){return t.playerApparence}},D=n("75fc"),F="SET_PLAYLIST",J="SET_CURRENT_INDEX",q="SET_PLAYING_STATE",z="SET_PLAY_HISTORY",G="SET_PLAYER_APPARENCE",K={selectPlay:function(t,e){var n=t.commit,r=e.list,i=e.index;n(F,r),n(J,i),n(q,!0),n(G,"normal")},insertPlay:function(t,e){var n=t.commit,r=t.state,i=Object(D["a"])(r.playlist),a=i.findIndex(function(t){return t.id===e.id});a>-1?n(J,a):(i.unshift(e),n(F,i),n(J,0)),n(q,!0),n(G,"normal")},playAll:function(t,e){var n=t.commit;n(F,e),n(J,0),n(q,!0),n(G,"normal")},setPlayHistory:function(t,e){var n=t.commit;n(z,W(e))},removeItemFromPlayHistory:function(){},clearPlayHistory:function(t){var e=t.commit;e(z,B())}},Q=n("bd86"),Z=(V={},Object(Q["a"])(V,F,function(t,e){t.playlist=e}),Object(Q["a"])(V,J,function(t,e){t.currentIndex=e}),Object(Q["a"])(V,q,function(t,e){t.isPlaying=e}),Object(Q["a"])(V,z,function(t,e){t.playHistory=e}),Object(Q["a"])(V,G,function(t,e){t.playerApparence=e}),V),tt=Z;r["a"].use(d["a"]);var et=new d["a"].Store({state:Y,mutations:tt,actions:K,getters:U}),nt=n("fe3c"),rt=n.n(nt),it=n("283e"),at=n.n(it);n("2e0d");rt.a.attach(document.body),r["a"].use(I["a"]),r["a"].use(at.a),new r["a"]({router:M,store:et,render:function(t){return t(S)}}).$mount("#app")},a402:function(t,e,n){},ad9a:function(t,e,n){"use strict";var r=n("a402"),i=n.n(r);i.a},b21a:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i});n("cadf"),n("551c"),n("f751"),n("097d");var r="http://192.168.0.100:3000",i={listLoop:0,singleLoop:1,random:2}},e771:function(t,e,n){t.exports=n.p+"img/cd.4b7d0b2f.png"}});
//# sourceMappingURL=app.49dcbbcf.js.map